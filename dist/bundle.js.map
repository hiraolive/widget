{"version":3,"file":"bundle.js","sources":["webpack://widget/webpack/runtime/rspack_version","webpack://widget/webpack/runtime/rspack_unique_id","webpack://widget/./src/index.ts"],"sourcesContent":["__webpack_require__.rv = () => (\"1.4.5\")","__webpack_require__.ruid = \"bundler=rspack@1.4.5\";\n","interface WidgetData {\n  name: string;\n  color: string;\n  show: boolean;\n  title?: string;\n  grade?: string;\n  rate?: string;\n  category?: string;\n}\n\nclass Widget extends HTMLElement {\n  private data: WidgetData;\n  private shadow: ShadowRoot;\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: \"open\" });\n    this.data = {\n      name: \"\",\n      color: \"\",\n      show: false,\n    };\n\n    this.shadow.innerHTML = `\n      <style>\n        .card {}\n        .link {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          padding: 1rem;\n          border-radius: 3px;\n        }\n        .widgetBody {\n          padding: 1rem;\n          display: flex;\n          background: #f9f9f9;\n          border: 1px solid #ccc;\n          flex-direction: column;\n          height: 400px;\n          margin-bottom: 16px;\n          width: 400px;\n          max-width: 100%;\n          border-radius: 20px;\n          opacity: 1;\n          margin-right: 16px;\n          transition: opacity 1s;\n        }\n        .widgetBody.show {\n          opacity: 1;\n        }\n        .icon {\n          display: none;\n          width: 50px;\n          height: 50px;\n          border-radius: 50px;\n          justify-content: center;\n          align-items: center;\n          position: absolute;\n          right: 15px;\n          top: -50px;\n          margin-top: -6px;\n        }\n        .icon svg {\n          width: 30px;\n          height: 30px;\n        }\n        .icon svg path {\n          stroke: #ff0000;\n        }\n      </style>\n      <div class=\"card\">\n        <div class=\"icon\"></div>\n        <div class=\"widgetBody\"></div>\n      </div>\n    `;\n  }\n\n  private isDark(bgColor: string): boolean {\n    try {\n      const rgb = bgColor.match(/\\d+/g)?.map(Number);\n      if (!rgb || rgb.length < 3) return false;\n      const [r, g, b] = rgb;\n      const luminance = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n      return luminance < 128;\n    } catch (error) {\n      console.error(error);\n      return false;\n    }\n  }\n\n  static get observedAttributes(): string[] {\n    return [\"color\", \"position\", \"zindex\"];\n  }\n\n  private changePosition(newValue: string): void {\n    try {\n      const widget = document.querySelector(\"insurance-widget\") as HTMLElement;\n      const card = this.shadow.querySelector(\".card\") as HTMLElement;\n      const icon = this.shadow.querySelector(\".icon\") as HTMLElement;\n      if (!card || !icon || !widget) return;\n\n      if (newValue === \"bottom-right\") {\n        widget.style.left = \"auto\";\n        widget.style.right = \"0\";\n        icon.style.left = \"auto\";\n        icon.style.right = \"15px\";\n      } else if (newValue === \"bottom-left\") {\n        widget.style.left = \"15px\";\n        widget.style.right = \"auto\";\n        icon.style.left = \"0\";\n        icon.style.right = \"auto\";\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private changeColor(value: string): void {\n    try {\n      console.log(\"changeColor\");\n      const icon = this.shadow.querySelector(\".icon\") as HTMLElement | null;\n      const widgetBody = this.shadow.querySelector(\".widgetBody\") as HTMLElement | null;\n      const link = this.shadow.querySelector(\"a\") as HTMLAnchorElement | null;\n\n      if (icon) icon.style.backgroundColor = value;\n      if (widgetBody) widgetBody.style.border = `solid 1px ${value}`;\n      if (link) {\n        link.style.backgroundColor = value;\n        link.style.color = this.isDark(value) ? \"#000000\" : \"#ffffff\";\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private changeZindex(value: string): void {\n    const card = this.shadow.querySelector(\".card\") as HTMLElement;\n    card.style.zIndex = value;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null): void {\n    if (!newValue) return;\n\n    switch (name) {\n      case \"color\":\n        this.changeColor(newValue);\n        break;\n      case \"position\":\n        this.changePosition(newValue);\n        break;\n      case \"zindex\":\n        this.changeZindex(newValue);\n        break;\n    }\n  }\n\n  private toggleBox(e: MouseEvent): void {\n    console.log(\"toggleBox\");\n    const widget = document.querySelector(\"insurance-widget\") as HTMLElement;\n    const widgetBody = this.shadow.querySelector(\".widgetBody\") as HTMLElement;\n\n    if (this.data.show) {\n      widget.style.bottom = \"-445px\";\n      widgetBody.classList.remove(\"show\");\n    } else {\n      widget.style.bottom = \"0px\";\n      widgetBody.classList.add(\"show\");\n    }\n\n    this.data.show = !this.data.show;\n    e.preventDefault();\n  }\n\n  async connectedCallback(): Promise<void> {\n    document.addEventListener(\"DOMContentLoaded\", async () => {\n      console.log(\"DOM is loaded!\");\n      const wid = this.getAttribute(\"wid\");\n      console.log(wid);\n\n      try {\n        const result = await fetch(\"https://cdn.jsdelivr.net/gh/hiraolive/widget/json/data.json\");\n        const data: Partial<WidgetData> = await result.json();\n        this.data = { ...this.data, ...data };\n\n        const widgetBody = this.shadow.querySelector(\".widgetBody\") as HTMLElement;\n\n        if (data && widgetBody) {\n          widgetBody.innerHTML = `\n            <div>\n              <h3>${this.data.title || \"\"}</h3>\n              <strong>Grade: ${this.data.grade || \"\"}</strong>\n              <strong>Rate: ${this.data.rate || \"\"}</strong>\n              <h4>${this.data.category || \"\"}</h4>\n              <a class=\"link\" href=\"http://google.com\">Google</a>\n            </div>`;\n        }\n\n        const icon = this.shadow.querySelector(\".icon\") as HTMLElement;\n        icon.addEventListener(\"click\", this.toggleBox.bind(this));\n\n        const widget = document.querySelector(\"insurance-widget\") as HTMLElement;\n        widget.style.position = \"fixed\";\n        widget.style.right = \"0px\";\n        widget.style.bottom = \"0\";\n        widget.style.transition = \"all 1s\";\n\n        const color = this.getAttribute(\"color\");\n        const zindex = this.getAttribute(\"zindex\");\n\n        if (color) this.changeColor(color);\n        if (zindex) widget.style.zIndex = zindex;\n      } catch (error) {\n        console.error(\"Failed to load widget data:\", error);\n      }\n    });\n  }\n}\n\ncustomElements.define(\"insurance-widget\", Widget);\n"],"names":["Widget","HTMLElement","constructor","shadow","attachShadow","mode","data","name","color","show","innerHTML","isDark","bgColor","rgb","match","map","Number","length","r","g","b","luminance","error","console","observedAttributes","changePosition","newValue","widget","document","querySelector","card","icon","style","left","right","changeColor","value","log","widgetBody","link","backgroundColor","border","changeZindex","zIndex","attributeChangedCallback","oldValue","toggleBox","e","bottom","classList","remove","add","preventDefault","connectedCallback","addEventListener","wid","getAttribute","result","fetch","json","title","grade","rate","category","bind","position","transition","zindex","customElements","define"],"mappings":"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"}